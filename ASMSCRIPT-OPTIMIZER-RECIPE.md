# **ASMSCRIPT-OPTIMIZER-RECIPE v1.3.1**
**AssemblyScript WebAssembly ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©çµ±åˆå‹å˜ä¸€HTMLã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆãƒ¬ã‚·ãƒ”**

---

## **ğŸ“Œ ã“ã®ãƒ¬ã‚·ãƒ”ã«ã¤ã„ã¦**

ç”ŸæˆAIãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã‚’è§£é‡ˆã—ã€AssemblyScriptã‚³ãƒ¼ãƒ‰ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§WebAssemblyã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»å®Ÿè¡Œã™ã‚‹**é«˜æ€§èƒ½å˜ä¸€HTMLãƒ•ã‚¡ã‚¤ãƒ«**ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãŸã‚ã®æ±ç”¨æŒ‡ç¤ºæ›¸ã§ã™ã€‚æœ¬ãƒ¬ã‚·ãƒ”ã¯ç‰¹å®šã®AIç’°å¢ƒã«ä¾å­˜ã›ãšã€ã‚ã‚‰ã‚†ã‚‹ç”ŸæˆAIã‚·ã‚¹ãƒ†ãƒ ã§åˆ©ç”¨å¯èƒ½ãªè¨­è¨ˆã¨ãªã£ã¦ã„ã¾ã™ã€‚

---

### **åŸºæœ¬æ©Ÿèƒ½**
- ğŸš€ **è‡ªå‹•åˆæœŸåŒ–**: ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«è‡ªå‹•çš„ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ»å®Ÿè¡Œé–‹å§‹
- ğŸ”§ **15ç¨®é¡ä»¥ä¸Šã®æœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: è©³ç´°ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«åˆ¶å¾¡
- ğŸ“¦ **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: å¤šæ§˜ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¯¾å¿œ
- âš¡ **CDNãƒ™ãƒ¼ã‚¹**: å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ä¸è¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ã§å®Œçµ

---

## **ğŸ¯ AIå®Ÿè£…ã®æ‰‹é †**

### **ã‚¹ãƒ†ãƒƒãƒ—0: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ã®ç¢ºèªï¼ˆå¿…é ˆï¼‰**

AIã¯æœ€åˆã«ä»¥ä¸‹ã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã€è¦æ±‚ãŒä¸æ˜ç¢ºãªå ´åˆã¯**å¿…ãšä½œæ¥­ã‚’ä¸­æ–­**ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã¾ã™ï¼š

#### **è¦æ±‚æ˜ç¢ºæ€§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**
1. **å…·ä½“çš„ãªå‡¦ç†å†…å®¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ**
   - âŒ ä¸æ˜ç¢ºãªä¾‹: ã€ŒAssemblyScriptã§ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã€
   - âœ… æ˜ç¢ºãªä¾‹: ã€ŒAssemblyScriptã§ç´ æ•°ã‚’è¨ˆç®—ã™ã‚‹ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã€

2. **ç”¨é€”ã‚„ã‚´ãƒ¼ãƒ«ãŒæ˜ç¢ºã‹ï¼Ÿ**
   - âŒ ä¸æ˜ç¢ºãªä¾‹: ã€Œæœ€é©åŒ–ã—ãŸã„ã€
   - âœ… æ˜ç¢ºãªä¾‹: ã€Œç”»åƒã®ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«å¤‰æ›ã‚’é«˜é€ŸåŒ–ã—ãŸã„ã€

3. **å…¥å‡ºåŠ›ã®ä»•æ§˜ãŒæ¨æ¸¬å¯èƒ½ã‹ï¼Ÿ**
   - âŒ ä¸æ˜ç¢ºãªä¾‹: ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¦ã€
   - âœ… æ˜ç¢ºãªä¾‹: ã€ŒCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã‚°ãƒ©ãƒ•ã‚’è¡¨ç¤ºã€

#### **ä½œæ¥­ä¸­æ–­ã¨å•ã„åˆã‚ã›ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**

```markdown
â“ **AssemblyScriptã§å®Ÿè£…ã™ã‚‹å†…å®¹ã‚’æ•™ãˆã¦ãã ã•ã„**

ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚å…·ä½“çš„ã«ã©ã®ã‚ˆã†ãªå‡¦ç†ã‚’å®Ÿè£…ã—ãŸã„ã‹æ•™ãˆã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ
ä»¥ä¸‹ã®æƒ…å ±ãŒã‚ã‚‹ã¨ã€æœ€é©ãªWebAssemblyã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã§ãã¾ã™ï¼š

**1. ä½•ã‚’ä½œã‚ŠãŸã„ã§ã™ã‹ï¼Ÿ**ï¼ˆä¾‹ã‚’é¸æŠã¾ãŸã¯è‡ªç”±è¨˜è¿°ï¼‰
â–¡ è¨ˆç®—å‡¦ç†ï¼ˆæ•°å€¤è¨ˆç®—ã€çµ±è¨ˆã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè¡Œãªã©ï¼‰
â–¡ ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆCanvasæç”»ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚²ãƒ¼ãƒ ãªã©ï¼‰  
â–¡ ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€å¤‰æ›ã€åˆ†æãªã©ï¼‰
â–¡ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ãªã©ï¼‰
â–¡ ãã®ä»–: [å…·ä½“çš„ã«è¨˜è¿°ã—ã¦ãã ã•ã„]

**2. å…·ä½“çš„ãªå‡¦ç†å†…å®¹**
ä¾‹ï¼š
- ã€Œ1000å€‹ã®ç´ æ•°ã‚’é«˜é€Ÿè¨ˆç®—ã—ãŸã„ã€
- ã€Œãƒœãƒ¼ãƒ«ã®ç‰©ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã‚ŠãŸã„ã€
- ã€Œç”»åƒã«ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ã—ãŸã„ã€
- ã€Œãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§éŸ³å£°ã‚’å‡¦ç†ã—ãŸã„ã€

**3. æœŸå¾…ã™ã‚‹æœ€é©åŒ–ã®æ–¹å‘æ€§**ï¼ˆä»»æ„ï¼‰
â–¡ å®Ÿè¡Œé€Ÿåº¦ã‚’æœ€å„ªå…ˆ
â–¡ ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æœ€å°åŒ–
â–¡ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’æŠ‘åˆ¶
â–¡ ãƒãƒ©ãƒ³ã‚¹é‡è¦–

å…·ä½“çš„ãªè¦æœ›ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚
```

### **ã‚¹ãƒ†ãƒƒãƒ—0.5: AssemblyScriptãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å‹•çš„å–å¾—**

HTMLã‚’ç”Ÿæˆã™ã‚‹å‰ã«ã€AIã¯ä»¥ä¸‹ã®æ‰‹é †ã§æœ€æ–°ã®å®‰å®šç‰ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¾ã™ï¼š

#### **å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—ã®å®Ÿè£…**

```javascript
// ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
const VersionManager = {
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹
    cache: {
        get() {
            try {
                const cached = sessionStorage.getItem('asc_version_cache');
                if (cached) {
                    const data = JSON.parse(cached);
                    // 1æ™‚é–“ä»¥å†…ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯æœ‰åŠ¹
                    if (Date.now() - data.timestamp < 3600000) {
                        return data.version;
                    }
                }
            } catch (e) {}
            return null;
        },
        set(version) {
            try {
                sessionStorage.setItem('asc_version_cache', JSON.stringify({
                    version,
                    timestamp: Date.now()
                }));
            } catch (e) {}
        }
    },
    
    async getLatestVersion() {
        // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
        const cached = this.cache.get();
        if (cached) {
            console.log(`[Version] Using cached: ${cached}`);
            return cached;
        }
        
        // jsDelivrå„ªå…ˆã®å–å¾—æˆ¦ç•¥
        const strategies = [
            { name: 'jsDelivr API', fn: () => this.fetchFromJsDelivr() },
            { name: 'jsDelivr Package', fn: () => this.fetchJsDelivrPackageJson() },
            { name: 'Unpkg', fn: () => this.fetchFromUnpkg() }
        ];
        
        for (const strategy of strategies) {
            try {
                console.log(`[Version] Trying ${strategy.name}...`);
                const version = await Promise.race([
                    strategy.fn(),
                    this.timeout(3000)
                ]);
                
                if (version && this.isValidStableVersion(version)) {
                    console.log(`[Version] Success: ${version}`);
                    this.cache.set(version);
                    return version;
                }
            } catch (e) {
                console.warn(`[Version] ${strategy.name} failed`);
            }
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        return "0.28.8";
    },
    
    async fetchFromJsDelivr() {
        const response = await fetch('https://data.jsdelivr.com/v1/package/npm/assemblyscript');
        const data = await response.json();
        const stable = data.versions.filter(v => this.isValidStableVersion(v));
        return stable[0];
    },
    
    async fetchJsDelivrPackageJson() {
        const response = await fetch('https://cdn.jsdelivr.net/npm/assemblyscript@latest/package.json');
        const data = await response.json();
        return data.version;
    },
    
    async fetchFromUnpkg() {
        const response = await fetch('https://unpkg.com/assemblyscript@latest/package.json');
        const data = await response.json();
        return data.version;
    },
    
    isValidStableVersion(version) {
        const semverRegex = /^(\d+)\.(\d+)\.(\d+)$/;
        if (!version.match(semverRegex)) return false;
        
        const preRelease = ['alpha', 'beta', 'rc', 'dev', '-'];
        return !preRelease.some(indicator => 
            version.toLowerCase().includes(indicator)
        );
    },
    
    timeout(ms) {
        return new Promise((_, reject) => 
            setTimeout(() => reject(new Error('Timeout')), ms)
        );
    }
};
```

### **ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ã®åˆ†æ**

AIã¯ä»¥ä¸‹ã®æ‰‹é †ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã‚’å‡¦ç†ã—ã¾ã™ï¼š

1. **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ç‰¹å®š**
   ```
   - ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç³»ï¼ˆCanvas/WebGLä½¿ç”¨ï¼‰ â†’ RenderModule
   - è¨ˆç®—å‡¦ç†ç³»ï¼ˆæ•°å€¤å‡ºåŠ›ï¼‰ â†’ ComputeModule  
   - ãƒ‡ãƒ¼ã‚¿å‡¦ç†ç³»ï¼ˆå¤‰æ›ãƒ»åˆ†æï¼‰ â†’ DataModule
   - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç³»ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ï¼‰ â†’ InteractiveModule
   ```

2. **AssemblyScriptã‚³ãƒ¼ãƒ‰ã®ç”Ÿæˆ/é¸æŠ**
   ```typescript
   // ä¾‹ï¼šç‰©ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆ
   export function update(dt: f32): void {
     // ç‰©ç†æ¼”ç®—ãƒ­ã‚¸ãƒƒã‚¯
   }
   ```

3. **é©åˆ‡ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—ã®æ±ºå®š**
   - å¿…è¦ãªWebAssemblyã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆé–¢æ•°
   - ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¦ä»¶ï¼ˆãƒ¡ãƒ¢ãƒªã€ç’°å¢ƒå¤‰æ•°ç­‰ï¼‰
   - å®Ÿè¡Œé »åº¦ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ— or ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ï¼‰

### **ã‚¹ãƒ†ãƒƒãƒ—2: AppModuleã®ç”Ÿæˆ**

é¸æŠã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«åŸºã¥ã„ã¦ã€AppModuleã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã—ã¾ã™ï¼š

```javascript
const AppModule = {
    name: "ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å",
    sourceCode: `AssemblyScriptã‚³ãƒ¼ãƒ‰`,
    defaultOptions: { /* æœ€é©ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ */ },
    execute: (exports) => { /* å®Ÿè¡Œãƒ­ã‚¸ãƒƒã‚¯ */ },
    render: (data) => { /* è¡¨ç¤ºæ›´æ–° */ }
};
```

### **ã‚¹ãƒ†ãƒƒãƒ—3: HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®çµ„ã¿ç«‹ã¦**

1. ã‚³ã‚¢æ§‹é€ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿
2. **å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—æ©Ÿèƒ½ã‚’çµ„ã¿è¾¼ã¿**
3. AppModuleã‚’åŸ‹ã‚è¾¼ã¿
4. å¿…è¦ã«å¿œã˜ã¦UIã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºéƒ¨åˆ†ã‚’è¿½åŠ 
5. å˜ä¸€HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›

---

## **ğŸš¨ å®Ÿè£…ãƒ«ãƒ¼ãƒ«ï¼ˆv1.3.1 ç°¡ç´ åŒ–ç‰ˆï¼‰**

### **ğŸ”´ çµ¶å¯¾ç¦æ­¢äº‹é …**

1. **ç›´æ¥importã®ä½¿ç”¨ç¦æ­¢**
   ```javascript
   // âŒ çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢ï¼ˆå‹•ä½œã—ãªã„ï¼‰
   import("https://cdn.jsdelivr.net/npm/assemblyscript@latest/dist/asc/index.js");
   
   // âœ… å¿…ãšå…¬å¼äº’æ›ã®web.jsæ–¹å¼ã‚’ä½¿ç”¨
   loadScriptTag("https://cdn.jsdelivr.net/npm/assemblyscript@0.28.8/dist/web.js");
   await import("assemblyscript/asc");
   ```

2. **@latestã‚¿ã‚°ã®ä½¿ç”¨ç¦æ­¢**
   ```javascript
   // âŒ çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢
   const url = "assemblyscript@latest/dist/web.js";
   
   // âœ… å¿…ãšå…·ä½“çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®š
   const version = await VersionManager.getLatestVersion(); // å‹•çš„å–å¾—
   const url = `assemblyscript@${version}/dist/web.js`;
   ```

3. **å˜ä¸€CDNã¸ã®ä¾å­˜ç¦æ­¢**
   ```javascript
   // âŒ å˜ä¸€CDNã®ã¿ã¯ç¦æ­¢
   const url = "https://cdn.jsdelivr.net/...";
   
   // âœ… å¿…ãš2ã¤ã®CDNã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
   const cdnProviders = ['jsDelivr', 'UNPKG'];
   ```

### **ğŸŸ¡ å¿…é ˆãƒ«ãƒ¼ãƒ«ï¼ˆv1.3.1ï¼‰**

1. **å…¬å¼äº’æ›ã®web.jsæ–¹å¼ã®ä½¿ç”¨**
   - web.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’å‹•çš„ã«æŒ¿å…¥
   - import mapè¨­å®šã‚’å¾…æ©Ÿ
   - "assemblyscript/asc"ã‚’import

2. **2æ®µéšCDNãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**
   - ç¬¬1å„ªå…ˆ: jsDelivrï¼ˆé«˜é€Ÿãƒ»å…¬å¼æ¨å¥¨ï¼‰
   - ç¬¬2å„ªå…ˆ: UNPKGï¼ˆå®‰å®šãƒ»npmãƒŸãƒ©ãƒ¼ï¼‰

3. **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä¿è­·**
   - å„CDNè©¦è¡Œã«10ç§’ã®ä¸Šé™
   - ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

4. **import mapå¾…æ©Ÿå‡¦ç†**
   - ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®ç¢ºèª
   - æœ€å¤§2ç§’ã®å¾…æ©Ÿæ™‚é–“

5. **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®è¨˜éŒ²**
   - ä½¿ç”¨ã—ãŸCDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
   - èª­ã¿è¾¼ã¿æ™‚é–“
   - è©¦è¡Œå›æ•°
   - ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—å…ƒ

### **ğŸŸ¢ æ¨å¥¨äº‹é …**

1. **ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®å‡ºåŠ›**
   - å„CDNè©¦è¡Œã®ãƒ­ã‚°
   - æˆåŠŸ/å¤±æ•—ã®è©³ç´°
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š

2. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ˜ç¢ºåŒ–**
   - ã©ã®CDNãŒå¤±æ•—ã—ãŸã‹
   - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å•é¡Œã‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³å•é¡Œã‹

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**
   - ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®æ›´æ–°
   - ç¾åœ¨è©¦è¡Œä¸­ã®CDNè¡¨ç¤º

### ğŸŸ  å‹å¤‰æ›ã«é–¢ã™ã‚‹é‡è¦æ³¨æ„äº‹é …

AssemblyScriptã¯**æš—é»™çš„ãªå‹å¤‰æ›ã‚’ä¸€åˆ‡è¨±å¯ã—ãªã„**å³æ ¼ãªå‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ç‰¹ã«ã€JavaScriptã®`number`ã«ç›¸å½“ã™ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æµ®å‹•å°æ•°ç‚¹å‹ã¯`f64`ã§ã‚ã‚‹ãŸã‚ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä¸Šã®ç†ç”±ã§`f32`ã‚’ä½¿ç”¨ã™ã‚‹éš›ã«ã¯ã€æ„è­˜çš„ãªå‹å¤‰æ›ãŒä¸å¯æ¬ ã§ã™ã€‚

#### 1. åŸºæœ¬ãƒ«ãƒ¼ãƒ«ï¼šæ˜ç¤ºçš„ãªå‹ã‚­ãƒ£ã‚¹ãƒˆã‚’æ¨å¥¨

**ç¾åœ¨ã®AssemblyScriptã§ã¯ã€`1.23f`ã®ã‚ˆã†ãª`f`ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹è¨˜æ³•ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“**ã€‚`f64`ã‹ã‚‰`f32`ã¸ã®å¤‰æ›ã¯ã€**`<f32>value`** ã¨ã„ã†æ˜ç¤ºçš„ãªå‹ã‚­ãƒ£ã‚¹ãƒˆã§è¡Œã†ã®ãŒæœ€ã‚‚å®‰å…¨ã§ç¢ºå®Ÿãªæ–¹æ³•ã§ã™ã€‚

| çŠ¶æ³ | å¯¾å‡¦æ³• | è¨˜æ³•ï¼ˆä¾‹ï¼‰ |
| :--- | :--- | :--- |
| **æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«** | **æ˜ç¤ºçš„ãªã‚­ãƒ£ã‚¹ãƒˆ**ã‚’æ¨å¥¨ã€‚ | `const gravity: f32 = <f32>9.8;` |
| **å¤‰æ•°ã¸ã®ä»£å…¥** | å‹æ¨è«–ãŒåŠ¹ãå ´åˆã‚‚ã‚ã‚‹ãŒã€ã‚­ãƒ£ã‚¹ãƒˆãŒå®‰å…¨ã€‚ | `let value: f32 = <f32>someF64Value;` |
| **`Math`é–¢æ•°** | æˆ»ã‚Šå€¤ã¯å¸¸ã«`f64`ã®ãŸã‚ã€**ã‚­ãƒ£ã‚¹ãƒˆãŒå¿…é ˆ**ã€‚ | `const sinValue: f32 = <f32>Math.sin(angle);` |
| **æ¼”ç®—** | æ¼”ç®—å­ã®ä¸¡è¾ºã®å‹ã‚’`f32`ã«çµ±ä¸€ã™ã‚‹ã€‚ | `const result: f32 = val1 * <f32>0.5;` |

#### 2. ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å³åº§ã®å¯¾å‡¦

* **`Type 'f64' is not assignable to type 'f32'`**
    â†’ `f64`ã®å€¤ã®å‰ã«**`<f32>`ã‚­ãƒ£ã‚¹ãƒˆã‚’è¿½åŠ **ã—ã¾ã™ã€‚ï¼ˆä¾‹ï¼š `<f32>Math.PI`ï¼‰

* **`Operator '*' cannot be applied to types 'f32' and 'f64'`**
    â†’ `f64`å´ã®å€¤ã«**`<f32>`ã‚­ãƒ£ã‚¹ãƒˆã‚’è¿½åŠ **ã—ã€ä¸¡è¾ºã®å‹ã‚’`f32`ã«çµ±ä¸€ã—ã¾ã™ã€‚

#### 3. å‹é¸æŠã®æŒ‡é‡ï¼ˆå¤‰æ›´ãªã—ï¼‰

**f32ã‚’ä½¿ç”¨ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å„ªå…ˆï¼‰**
* Canvas/WebGLæç”»
* ã‚²ãƒ¼ãƒ ç‰©ç†æ¼”ç®—
* ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†
* ãƒ¡ãƒ¢ãƒªåˆ¶ç´„ãŒã‚ã‚‹å ´åˆ

**f64ã‚’ä½¿ç”¨ï¼ˆç²¾åº¦å„ªå…ˆï¼‰**
* ç§‘å­¦è¨ˆç®—ãƒ»é‡‘èè¨ˆç®—
* ç´¯ç©èª¤å·®ãŒå•é¡Œã¨ãªã‚‹å ´åˆ
* JavaScriptã¨ã®äº’æ›æ€§é‡è¦–

#### 4. ã‚³ãƒ¼ãƒ‰ç”Ÿæˆå‰ãƒã‚§ãƒƒã‚¯é …ç›®

* [ ] `f32`ã‚’æœŸå¾…ã™ã‚‹ç®‡æ‰€ã§ã€`f64`ã¨ãªã‚Šã†ã‚‹å€¤ï¼ˆæ•°å€¤ãƒªãƒ†ãƒ©ãƒ«ã€`Math.*`é–¢æ•°ã®æˆ»ã‚Šå€¤ãªã©ï¼‰ã«`<f32>`ã‚­ãƒ£ã‚¹ãƒˆãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
* [ ] ç•°ãªã‚‹æµ®å‹•å°æ•°ç‚¹å‹åŒå£«ã®æ¼”ç®—ãŒè¡Œã‚ã‚Œã¦ã„ãªã„ã‹ï¼Ÿ
* [ ] å®šæ•°å®šç¾©ã§å‹ã‚’æ˜ç¤ºã—ã¦ã„ã‚‹ã‹ï¼Ÿ (`const G: f32 = <f32>9.8`)

**é‡è¦**: AssemblyScriptã®æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯`f64`ã§ã™ã€‚`f32`ã¨ã—ã¦æ‰±ã„ãŸã„å ´åˆã¯ã€å¿…ãšå‹ã‚’æ„è­˜ã—ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¿…è¦ã§ã™ã€‚

---

## **ğŸ“„ å…¬å¼æ¨å¥¨æ–¹å¼äº’æ›ã«ã‚ˆã‚‹å®Ÿè£…ï¼ˆv1.3.1ï¼‰**

### **å®Ÿè£…ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ**

```
AssemblyScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ©èª­ã¿è¾¼ã¿é–‹å§‹
    â†“
ãƒãƒ¼ã‚¸ãƒ§ãƒ³å‹•çš„å–å¾—
    â”œâ”€ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèª â†’ ã‚ã‚Œã°ä½¿ç”¨
    â””â”€ æ–°è¦å–å¾—
        â”œâ”€ jsDelivr API
        â”œâ”€ jsDelivr package.json
        â””â”€ UNPKG package.json
    â†“
CDNé¸æŠãƒ«ãƒ¼ãƒ—é–‹å§‹
    â†“
1. jsDelivrè©¦è¡Œ
    â”œâ”€ web.jsèª­ã¿è¾¼ã¿ â†’ import mapè¨­å®š â†’ asc import
    â”œâ”€ æˆåŠŸ â†’ ä½¿ç”¨é–‹å§‹
    â””â”€ å¤±æ•— â†’ æ¬¡ã®CDNã¸
    â†“
2. UNPKGè©¦è¡Œ
    â”œâ”€ web.jsèª­ã¿è¾¼ã¿ â†’ import mapè¨­å®š â†’ asc import
    â”œâ”€ æˆåŠŸ â†’ ä½¿ç”¨é–‹å§‹
    â””â”€ å¤±æ•— â†’ ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
```

### **CDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®šï¼ˆv1.3.1ï¼‰**

```javascript
const CDN_PROVIDERS = [
    {
        name: 'jsDelivr',
        baseUrl: 'https://cdn.jsdelivr.net/npm',
        characteristics: 'é«˜é€Ÿãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«æœ€é©åŒ–ãƒ»AssemblyScriptå…¬å¼æ¨å¥¨'
    },
    {
        name: 'UNPKG',
        baseUrl: 'https://unpkg.com',
        characteristics: 'npmå…¬å¼ãƒŸãƒ©ãƒ¼ãƒ»å®Œå…¨æ€§ä¿è¨¼ãƒ»å®‰å®šæ€§é‡è¦–'
    }
];
```

### **èª­ã¿è¾¼ã¿å‡¦ç†ã®è©³ç´°å®Ÿè£…**

```javascript
// CDNãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯¾å¿œãƒ­ãƒ¼ãƒ€ãƒ¼ï¼ˆv1.3.1ç°¡ç´ åŒ–ç‰ˆï¼‰
async function loadCompilerWithCDNFallback() {
    const version = await VersionManager.getLatestVersion();
    
    for (let i = 0; i < CDN_PROVIDERS.length; i++) {
        const cdn = CDN_PROVIDERS[i];
        const startTime = performance.now();
        
        try {
            updateProgress(30 + (i * 35), `ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©èª­ã¿è¾¼ã¿ä¸­ (${cdn.name})...`);
            
            // web.jsã®URLã‚’æ§‹ç¯‰
            const webJsUrl = `${cdn.baseUrl}/assemblyscript@${version}/dist/web.js`;
            console.log(`[Loader] Attempting ${cdn.name}: ${webJsUrl}`);
            
            // web.jsã‚’èª­ã¿è¾¼ã¿
            await loadScriptTag(webJsUrl);
            
            // import mapã®è¨­å®šã‚’å¾…æ©Ÿ
            await waitForImportMap();
            
            // assemblyscript/ascã‚’import
            const asc = await import("assemblyscript/asc");
            const compiler = asc.default || asc;
            
            // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®æ¤œè¨¼
            await validateCompiler(compiler);
            
            // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
            const loadTime = Math.round(performance.now() - startTime);
            COMPILER_METADATA.cdnProvider = cdn.name;
            COMPILER_METADATA.loadTime = loadTime;
            COMPILER_METADATA.attempts = i + 1;
            COMPILER_METADATA.versionSource = 'Dynamic fetch';
            
            console.log(`[Loader] Success with ${cdn.name} in ${loadTime}ms`);
            updateProgress(100, 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æº–å‚™å®Œäº†');
            
            return compiler;
            
        } catch (error) {
            console.error(`[Loader] ${cdn.name} failed:`, error.message);
            
            // ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            cleanupFailedScripts();
        }
    }
    
    throw new Error(`All CDN providers failed for AssemblyScript ${version}`);
}

// ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°èª­ã¿è¾¼ã¿é–¢æ•°
function loadScriptTag(url) {
    return new Promise((resolve, reject) => {
        // æ—¢å­˜ã®AssemblyScriptãƒã‚§ãƒƒã‚¯
        if (window.ASSEMBLYSCRIPT_VERSION) {
            console.log('[Loader] AssemblyScript already loaded');
            resolve();
            return;
        }
        
        const script = document.createElement('script');
        script.src = url;
        script.dataset.assemblyScript = 'loading';
        
        // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆ10ç§’ï¼‰
        const timeout = setTimeout(() => {
            script.remove();
            reject(new Error(`Timeout loading: ${url}`));
        }, 10000);
        
        script.onload = () => {
            clearTimeout(timeout);
            script.dataset.assemblyScript = 'loaded';
            resolve();
        };
        
        script.onerror = () => {
            clearTimeout(timeout);
            script.remove();
            reject(new Error(`Failed to load: ${url}`));
        };
        
        document.head.appendChild(script);
    });
}

// import mapå¾…æ©Ÿé–¢æ•°
async function waitForImportMap() {
    const maxAttempts = 20;
    const waitTime = 100;
    
    for (let i = 0; i < maxAttempts; i++) {
        if (window.ASSEMBLYSCRIPT_VERSION && window.ASSEMBLYSCRIPT_IMPORTMAP) {
            console.log('[Loader] Import map ready');
            return;
        }
        await new Promise(resolve => setTimeout(resolve, waitTime));
    }
    
    throw new Error('Import map setup timeout');
}

// å¤±æ•—ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
function cleanupFailedScripts() {
    const scripts = document.querySelectorAll('script[data-assembly-script]');
    scripts.forEach(script => {
        if (script.dataset.assemblyScript !== 'loaded') {
            script.remove();
        }
    });
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚‚ã‚¯ãƒªã‚¢
    delete window.ASSEMBLYSCRIPT_VERSION;
    delete window.ASSEMBLYSCRIPT_IMPORTMAP;
}
```

---

## **ğŸ”§ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»•æ§˜**

### **åŸºæœ¬ã‚ªãƒ—ã‚·ãƒ§ãƒ³**

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|----------|------|
| `--optimize` | false | Binaryenæœ€é©åŒ–ã®æœ‰åŠ¹åŒ– |
| `--optimizeLevel` | 3 | æœ€é©åŒ–ãƒ¬ãƒ™ãƒ« (0-3) |
| `--shrinkLevel` | 0 | ã‚µã‚¤ã‚ºå‰Šæ¸›ãƒ¬ãƒ™ãƒ« (0-2) |
| `--runtime` | minimal | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ é¸æŠ (stub/minimal/incremental) |
| `--debug` | false | ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®ç”Ÿæˆ |
| `--sourceMap` | false | ã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ç”Ÿæˆ |
| `--noAssert` | false | ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®ç„¡åŠ¹åŒ– |

### **é«˜åº¦ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³**

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ | ä½¿ç”¨ä¾‹ |
|-----------|------|--------|
| `--importMemory` | WebAssemblyãƒ¡ãƒ¢ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ | å…±æœ‰ãƒ¡ãƒ¢ãƒªä½¿ç”¨æ™‚ |
| `--sharedMemory` | SharedArrayBufferä½¿ç”¨ | ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰å‡¦ç† |
| `--exportRuntime` | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ APIã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ | é«˜åº¦ãªãƒ¡ãƒ¢ãƒªç®¡ç† |
| `--explicitStart` | _starté–¢æ•°ã®æ˜ç¤ºçš„å‘¼ã³å‡ºã— | åˆæœŸåŒ–åˆ¶å¾¡ |
| `--lowMemoryLimit` | ä½ãƒ¡ãƒ¢ãƒªç’°å¢ƒå‘ã‘æœ€é©åŒ– | çµ„ã¿è¾¼ã¿ãƒ–ãƒ©ã‚¦ã‚¶ |

### **ãƒ—ãƒªã‚»ãƒƒãƒˆå®šç¾©**

```javascript
const PRESETS = {
    simple: {
        optimize: false,
        runtime: 'minimal'
    },
    debug: {
        optimize: false,
        optimizeLevel: '0',
        debug: true,
        sourceMap: true,
        measure: true
    },
    release: {
        optimize: true,
        optimizeLevel: '3',
        shrinkLevel: '1',
        noAssert: true
    },
    minimal: {
        optimize: true,
        optimizeLevel: '3',
        shrinkLevel: '2',
        runtime: 'stub',
        noAssert: true
    }
};
```

---

## **ğŸ“¦ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**

### **Layer 1: ã‚³ã‚¢ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆv1.3.1 å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œç‰ˆï¼‰**

```javascript
// ============================================
// ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
// ============================================
const COMPILER_METADATA = {
    version: null,          // å‹•çš„å–å¾—
    versionSource: null,    // å–å¾—å…ƒï¼ˆDynamic/Fallbackï¼‰
    fetchedFrom: "NPM Registry via CDN",
    generatedAt: new Date().toISOString(),
    cdnProvider: null,      // æˆåŠŸã—ãŸCDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
    loadTime: null,         // èª­ã¿è¾¼ã¿æ™‚é–“ï¼ˆmsï¼‰
    attempts: 0,            // è©¦è¡Œå›æ•°
    
    async initialize() {
        const startTime = performance.now();
        try {
            this.version = await VersionManager.getLatestVersion();
            this.versionSource = 'Dynamic fetch';
            console.log(`[Version] Fetched: v${this.version}`);
        } catch (error) {
            this.version = "0.28.8";
            this.versionSource = 'Hardcoded fallback';
            console.warn('[Version] Using fallback version');
        }
        const fetchTime = Math.round(performance.now() - startTime);
        console.log(`[Version] Time: ${fetchTime}ms`);
    }
};

// ============================================
// CDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å®šç¾©ï¼ˆv1.3.1ç°¡ç´ åŒ–ç‰ˆï¼‰
// ============================================
const CDN_PROVIDERS = [
    {
        name: 'jsDelivr',
        baseUrl: 'https://cdn.jsdelivr.net/npm',
        timeout: 10000,
        priority: 1
    },
    {
        name: 'UNPKG',
        baseUrl: 'https://unpkg.com',
        timeout: 10000,
        priority: 2
    }
];

// ============================================
// ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆv1.3.1æ–°è¦ï¼‰
// ============================================
const VersionManager = {
    // å®Ÿè£…ã¯ä¸Šè¨˜ã‚¹ãƒ†ãƒƒãƒ—0.5ã‚’å‚ç…§
};

// ============================================
// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ­ãƒ¼ãƒ€ãƒ¼ï¼ˆå…¬å¼äº’æ›æ–¹å¼çµ±ä¸€ç‰ˆï¼‰
// ============================================
const CompilerLoader = {
    compiler: null,
    
    async load() {
        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‹•çš„å–å¾—
        await COMPILER_METADATA.initialize();
        
        // CDNãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãƒ­ãƒ¼ãƒ‰
        return await loadCompilerWithCDNFallback();
    }
};

// ============================================
// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚³ã‚¢
// ============================================
const CompilerCore = {
    compiler: null,
    
    init(ascInstance) {
        this.compiler = ascInstance;
        return true;
    },
    
    async compile(sourceCode, options) {
        if (!this.compiler) {
            throw new Error('Compiler not initialized');
        }
        
        const compileOptions = this.buildOptions(options);
        let wasmBinary = null;
        let compileStats = '';
        
        const { error, stdout, stderr } = await this.compiler.main(compileOptions, {
            readFile: (filename) => {
                if (filename === "main.ts") return sourceCode;
                return null;
            },
            writeFile: (filename, contents) => {
                if (filename === "main.wasm") {
                    wasmBinary = contents;
                }
            },
            listFiles: () => ["main.ts"]
        });
        
        if (error) throw new Error(stderr || error.toString());
        if (!wasmBinary) throw new Error('No WebAssembly binary generated');
        
        if (stdout) compileStats = stdout;
        
        return { wasmBinary, stats: compileStats };
    },
    
    buildOptions(userOptions) {
        const flags = ["main.ts", "-o", "main.wasm"];
        
        Object.entries(userOptions).forEach(([key, value]) => {
            if (typeof value === 'boolean' && value) {
                flags.push(`--${key}`);
            } else if (typeof value !== 'boolean' && value !== '') {
                flags.push(`--${key}`, value.toString());
            }
        });
        
        return flags;
    }
};

// ============================================
// ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
// ============================================
const OptionsManager = {
    current: {},
    
    init() {
        this.current = { runtime: 'minimal' };
        this.loadFromStorage();
        this.updateUI();
    },
    
    apply(preset) {
        if (PRESETS[preset]) {
            this.current = { ...PRESETS[preset] };
            this.updateUI();
            this.saveToStorage();
        }
    },
    
    collectFromUI() {
        const options = {};
        
        // Boolean options
        ['optimize', 'exportRuntime', 'noAssert', 'debug', 'sourceMap',
         'measure', 'validate', 'importMemory', 'sharedMemory',
         'exportTable', 'explicitStart', 'lowMemoryLimit'].forEach(opt => {
            const el = document.getElementById(`opt-${opt}`);
            if (el && el.checked) options[opt] = true;
        });
        
        // Select options
        ['optimizeLevel', 'shrinkLevel', 'runtime'].forEach(opt => {
            const el = document.getElementById(`opt-${opt}`);
            if (el && el.value) options[opt] = el.value;
        });
        
        this.current = options;
        this.saveToStorage();
        return options;
    },
    
    updateUI() {
        Object.keys(this.current).forEach(key => {
            const el = document.getElementById(`opt-${key}`);
            if (el) {
                if (el.type === 'checkbox') {
                    el.checked = this.current[key] === true;
                } else {
                    el.value = this.current[key] || '';
                }
            }
        });
    },
    
    saveToStorage() {
        try {
            localStorage.setItem('asmOptions', JSON.stringify(this.current));
        } catch(e) {}
    },
    
    loadFromStorage() {
        try {
            const saved = localStorage.getItem('asmOptions');
            if (saved) this.current = JSON.parse(saved);
        } catch(e) {}
    }
};

// ============================================
// WebAssemblyå®Ÿè¡Œç®¡ç†
// ============================================
const WasmRunner = {
    instance: null,
    
    async instantiate(wasmBinary, imports = {}) {
        const defaultImports = {
            env: {
                abort: (msg, file, line, column) => {
                    console.error(`Abort: ${msg} at ${file}:${line}:${column}`);
                },
                trace: (msg, n, ...args) => {
                    console.log(`Trace: ${msg}`, ...args);
                },
                seed: () => Date.now(),
                memory: new WebAssembly.Memory({ initial: 1 })
            },
            Math: Math,
            Date: Date
        };
        
        const mergedImports = this.mergeImports(defaultImports, imports);
        
        let buffer;
        if (wasmBinary instanceof ArrayBuffer) {
            buffer = wasmBinary;
        } else if (wasmBinary instanceof Uint8Array) {
            buffer = wasmBinary.buffer.slice(wasmBinary.byteOffset, 
                                             wasmBinary.byteOffset + wasmBinary.byteLength);
        } else {
            throw new Error('Unexpected binary format');
        }
        
        const wasmModule = await WebAssembly.compile(buffer);
        this.instance = await WebAssembly.instantiate(wasmModule, mergedImports);
        
        return this.instance.exports;
    },
    
    mergeImports(defaults, custom) {
        const merged = { ...defaults };
        Object.keys(custom).forEach(key => {
            if (typeof custom[key] === 'object' && !Array.isArray(custom[key])) {
                merged[key] = { ...defaults[key], ...custom[key] };
            } else {
                merged[key] = custom[key];
            }
        });
        return merged;
    }
};

// ============================================
// ãƒ—ãƒªã‚»ãƒƒãƒˆå®šç¾©
// ============================================
const PRESETS = {
    simple: {
        optimize: false,
        runtime: 'minimal'
    },
    debug: {
        optimize: false,
        optimizeLevel: '0',
        debug: true,
        sourceMap: true,
        measure: true
    },
    release: {
        optimize: true,
        optimizeLevel: '3',
        shrinkLevel: '1',
        noAssert: true
    },
    minimal: {
        optimize: true,
        optimizeLevel: '3',
        shrinkLevel: '2',
        runtime: 'stub',
        noAssert: true
    }
};
```

### **Layer 2: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºé ˜åŸŸï¼‰**

```javascript
// AIãŒç”Ÿæˆã™ã‚‹éƒ¨åˆ†ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
const AppModule = {
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è­˜åˆ¥æƒ…å ±
    name: "UserDefinedApp",
    description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
    
    // AssemblyScriptã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
    sourceCode: `
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã«åŸºã¥ã„ã¦AIãŒç”Ÿæˆ
        export function main(): void {
            // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
        }
    `,
    
    // æ¨å¥¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³
    defaultOptions: {
        optimize: false,
        runtime: 'minimal'
    },
    
    // WebAssemblyã‚¤ãƒ³ãƒãƒ¼ãƒˆå®šç¾©
    getImports() {
        return {
            // å¿…è¦ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        };
    },
    
    // åˆæœŸåŒ–å‡¦ç†
    async init(wasmExports) {
        // åˆæœŸåŒ–ãƒ­ã‚¸ãƒƒã‚¯
    },
    
    // ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—å®Ÿè¡Œ
    execute(wasmExports, deltaTime) {
        // ãƒ•ãƒ¬ãƒ¼ãƒ æ¯ã®å‡¦ç†
    },
    
    // UIæ›´æ–°
    render(data) {
        // æç”»ãƒ»è¡¨ç¤ºæ›´æ–°
    },
    
    // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
    cleanup() {
        // ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾
    }
};
```

---

## **ğŸ“ HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆv1.3.1 å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œç‰ˆï¼‰**

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AssemblyScript WebAssembly App</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0;
            display: flex;
            align-items: center;
            height: 56px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .hamburger {
            width: 56px;
            height: 56px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .hamburger:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .hamburger span {
            width: 24px;
            height: 2px;
            background: white;
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }
        
        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }
        
        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        
        .header-content {
            flex: 1;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-title {
            display: flex;
            flex-direction: column;
        }
        
        .header-title h1 {
            font-size: 20px;
            font-weight: 600;
        }
        
        .header-title p {
            font-size: 12px;
            opacity: 0.9;
            margin-top: 2px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 13px;
        }
        
        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }
        
        .status-dot.loading {
            background: #ffc107;
        }
        
        .status-dot.error {
            background: #dc3545;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
        .side-menu {
            position: fixed;
            top: 56px;
            left: -320px;
            width: 320px;
            height: calc(100vh - 56px);
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            transition: left 0.3s;
            z-index: 999;
            overflow-y: auto;
        }
        
        .side-menu.active {
            left: 0;
        }
        
        /* ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .tab-navigation {
            display: flex;
            background: #f3f4f6;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .tab-button {
            flex: 1;
            padding: 14px;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .tab-button:hover {
            background: rgba(0,0,0,0.03);
        }
        
        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }
        
        .tab-icon {
            font-size: 16px;
        }
        
        .tab-content {
            display: none;
            height: calc(100vh - 56px - 48px);
            overflow-y: auto;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .menu-section {
            border-bottom: 1px solid #e5e7eb;
        }
        
        .menu-header {
            padding: 16px 20px;
            background: #f9fafb;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background: #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle-switch.active {
            background: #667eea;
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .toggle-switch.active::after {
            left: 22px;
        }
        
        .menu-content {
            padding: 16px;
        }
        
        .presets {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .preset-btn {
            padding: 8px;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .preset-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f9fafb;
            border-radius: 6px;
            margin-bottom: 8px;
            gap: 10px;
        }
        
        .option-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }
        
        .option-item label {
            flex: 1;
            font-size: 13px;
        }
        
        .option-item select {
            padding: 4px 8px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            font-size: 12px;
            background: white;
        }
        
        .code-viewer {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 16px;
            margin-top: 8px;
        }
        
        .code-header {
            color: #9ca3af;
            font-size: 11px;
            margin-bottom: 12px;
            font-family: monospace;
            text-transform: uppercase;
        }
        
        .code-content {
            color: #e5e7eb;
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 12px;
            line-height: 1.5;
            white-space: pre;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
        }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            transition: margin-left 0.3s;
        }
        
        .main-container.menu-open {
            margin-left: 320px;
        }
        
        .main-content {
            flex: 1;
            padding: 24px;
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .app-viewport {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 40px;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 400px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ï¼ˆç”»é¢ä¸‹éƒ¨ï¼‰ */
        .status-bar {
            position: fixed;
            bottom: -48px;
            left: 0;
            right: 0;
            height: 48px;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            padding: 0 24px;
            transition: bottom 0.3s;
            z-index: 998;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }
        
        .status-bar.active {
            bottom: 0;
        }
        
        .status-bar.menu-open {
            left: 320px;
        }
        
        .stats-grid {
            display: flex;
            gap: 32px;
            align-items: center;
            width: 100%;
            justify-content: center;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #6b7280;
        }
        
        .stat-value {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
        }
        
        /* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        .overlay {
            position: fixed;
            top: 56px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 998;
        }
        
        .overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* ã‚¨ãƒ©ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        .error-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }
        
        .error-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .error-title {
            color: #dc3545;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .error-content {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 16px;
            font-family: monospace;
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 16px;
            white-space: pre-wrap;
            word-break: break-word;
        }
        
        .error-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        
        .error-btn {
            padding: 8px 16px;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .error-btn:hover {
            background: #f8f9fa;
        }
        
        .error-btn-primary {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .error-btn-primary:hover {
            background: #5a67d8;
        }
        
        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
        .progress-container {
            height: 4px;
            background: #e9ecef;
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-container.loading .progress-bar {
            animation: progress-indeterminate 1.5s infinite;
        }
        
        @keyframes progress-indeterminate {
            0% {
                width: 0%;
                margin-left: 0%;
            }
            50% {
                width: 30%;
                margin-left: 70%;
            }
            100% {
                width: 0%;
                margin-left: 100%;
            }
        }
        
        /* ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æƒ…å ±ãƒ‘ãƒãƒ« */
        .compiler-info {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-family: monospace;
            display: none;
            z-index: 500;
        }
        
        .compiler-info.show {
            display: block;
        }
        
        /* CDNçŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
        .cdn-status {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            margin-left: 4px;
        }
        
        .cdn-status.jsdelivr {
            background: #ff5627;
            color: white;
        }
        
        .cdn-status.unpkg {
            background: #000000;
            color: white;
        }
        
        /* ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚½ãƒ¼ã‚¹è¡¨ç¤º */
        .version-source {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            background: #4ade80;
            color: white;
        }
        
        .version-source.fallback {
            background: #ffc107;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .main-container.menu-open {
                margin-left: 0;
            }
            
            .side-menu {
                width: 280px;
                left: -280px;
            }
            
            .status-bar.menu-open {
                left: 0;
            }
            
            .stats-grid {
                gap: 16px;
                flex-wrap: wrap;
            }
        }
        
        @media (max-width: 480px) {
            .header-title p {
                display: none;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 13px;
            }
            
            .stats-grid {
                flex-direction: column;
                gap: 8px;
            }
            
            .main-content {
                padding: 16px;
            }
            
            .app-viewport {
                padding: 24px;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="header">
        <div class="hamburger" onclick="toggleMenu()" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="header-content">
            <div class="header-title">
                <h1 id="app-title">ğŸš€ AssemblyScript App</h1>
                <p id="app-description">WebAssembly Application</p>
            </div>
            <div class="status-indicator">
                <div class="status-dot" id="status-dot"></div>
                <span id="status-text">åˆæœŸåŒ–ä¸­...</span>
            </div>
        </div>
    </div>
    
    <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ -->
    <div class="progress-container loading" id="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>
    
    <!-- ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
    <div class="side-menu" id="sideMenu">
        <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="switchTab('app')">
                <span class="tab-icon">ğŸ“±</span>
                ã‚¢ãƒ—ãƒªè¨­å®š
            </button>
            <button class="tab-button" onclick="switchTab('wasm')">
                <span class="tab-icon">âš™ï¸</span>
                WebAssembly
            </button>
        </div>
        
        <!-- ã‚¢ãƒ—ãƒªè¨­å®šã‚¿ãƒ– -->
        <div class="tab-content active" id="appTab">
            <div class="menu-section">
                <div class="menu-header">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</div>
                <div class="menu-content">
                    <div class="option-item">
                        <input type="checkbox" id="autoRun" checked>
                        <label for="autoRun">è‡ªå‹•å®Ÿè¡Œ</label>
                    </div>
                    <div class="option-item">
                        <label>ãƒ†ãƒ¼ãƒ</label>
                        <select id="theme">
                            <option>ãƒ©ã‚¤ãƒˆ</option>
                            <option>ãƒ€ãƒ¼ã‚¯</option>
                            <option>ã‚·ã‚¹ãƒ†ãƒ </option>
                        </select>
                    </div>
                    <div class="option-item">
                        <label>è¨€èª</label>
                        <select id="language">
                            <option>æ—¥æœ¬èª</option>
                            <option>English</option>
                        </select>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="animations" checked>
                        <label for="animations">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ</label>
                    </div>
                </div>
            </div>
            
            <div class="menu-section">
                <div class="menu-header">è¡¨ç¤ºè¨­å®š</div>
                <div class="menu-content">
                    <div class="option-item">
                        <label>ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º</label>
                        <select id="fontSize">
                            <option>å°</option>
                            <option selected>ä¸­</option>
                            <option>å¤§</option>
                        </select>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="compactMode">
                        <label for="compactMode">ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰</label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- WebAssemblyè¨­å®šã‚¿ãƒ– -->
        <div class="tab-content" id="wasmTab">
            <div class="menu-section">
                <div class="menu-header">
                    WASMçµ±è¨ˆæƒ…å ±
                    <div class="toggle-switch" onclick="toggleStats()" id="statsToggle"></div>
                </div>
            </div>
            
            <div class="menu-section" style="padding: 16px;">
                <button class="btn btn-primary" style="width: 100%;" onclick="recompile()" id="recompileBtn">
                    âŸ³ å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
                </button>
            </div>
            
            <div class="menu-section">
                <div class="menu-header">ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ—ãƒªã‚»ãƒƒãƒˆ</div>
                <div class="menu-content">
                    <div class="presets">
                        <button class="preset-btn" onclick="applyPreset('simple')">ã‚·ãƒ³ãƒ—ãƒ«</button>
                        <button class="preset-btn" onclick="applyPreset('debug')">ãƒ‡ãƒãƒƒã‚°</button>
                        <button class="preset-btn" onclick="applyPreset('release')">ãƒªãƒªãƒ¼ã‚¹</button>
                        <button class="preset-btn" onclick="applyPreset('minimal')">æœ€å°ã‚µã‚¤ã‚º</button>
                    </div>
                </div>
            </div>
            
            <div class="menu-section">
                <div class="menu-header">æœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
                <div class="menu-content">
                    <div class="option-item">
                        <input type="checkbox" id="opt-optimize">
                        <label for="opt-optimize">--optimize</label>
                    </div>
                    <div class="option-item">
                        <label>--optimizeLevel</label>
                        <select id="opt-optimizeLevel">
                            <option value="">Default</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                    </div>
                    <div class="option-item">
                        <label>--shrinkLevel</label>
                        <select id="opt-shrinkLevel">
                            <option value="">Default</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="menu-section">
                <div class="menu-header">ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
                <div class="menu-content">
                    <div class="option-item">
                        <label>--runtime</label>
                        <select id="opt-runtime">
                            <option value="stub">stub</option>
                            <option value="minimal" selected>minimal</option>
                            <option value="incremental">incremental</option>
                        </select>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="opt-exportRuntime">
                        <label for="opt-exportRuntime">--exportRuntime</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="opt-importMemory">
                        <label for="opt-importMemory">--importMemory</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="opt-sharedMemory">
                        <label for="opt-sharedMemory">--sharedMemory</label>
                    </div>
                </div>
            </div>
            
            <div class="menu-section">
                <div class="menu-header">ãƒ‡ãƒãƒƒã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³</div>
                <div class="menu-content">
                    <div class="option-item">
                        <input type="checkbox" id="opt-debug">
                        <label for="opt-debug">--debug</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="opt-sourceMap">
                        <label for="opt-sourceMap">--sourceMap</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="opt-noAssert">
                        <label for="opt-noAssert">--noAssert</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="opt-validate">
                        <label for="opt-validate">--validate</label>
                    </div>
                </div>
            </div>
            
            <div class="menu-section">
                <div class="menu-header">
                    ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
                    <label style="margin-left: auto; display: flex; align-items: center; font-weight: normal; font-size: 12px;">
                        <input type="checkbox" id="showCode" checked style="margin-right: 6px;">
                        è¡¨ç¤º
                    </label>
                </div>
                <div class="menu-content" id="sourceContent">
                    <div class="code-viewer">
                        <div class="code-header">AssemblyScript</div>
                        <div class="code-content" id="source-code"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
    <div class="overlay" id="overlay" onclick="closeMenu()"></div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="main-container" id="mainContainer">
        <div class="main-content">
            <div class="app-viewport" id="app-viewport">
                <div style="text-align: center; color: #6b7280;">
                    <div style="font-size: 48px; margin-bottom: 16px;">âš™ï¸</div>
                    <div>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–ã—ã¦ã„ã¾ã™...</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ -->
    <div class="status-bar" id="statusBar">
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-label">WASM:</span>
                <span class="stat-value" id="stat-wasm-size">-</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«:</span>
                <span class="stat-value" id="stat-compile-time">-</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">æœ€é©åŒ–:</span>
                <span class="stat-value" id="stat-opt-level">-</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ãƒ¡ãƒ¢ãƒª:</span>
                <span class="stat-value" id="stat-memory">-</span>
            </div>
        </div>
    </div>
    
    <!-- ã‚¨ãƒ©ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
    <div class="error-overlay" id="error-overlay">
        <div class="error-card">
            <div class="error-title">
                âš ï¸ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ
            </div>
            <div class="error-content" id="error-content"></div>
            <div class="error-actions">
                <button class="error-btn" onclick="copyError()">ã‚¨ãƒ©ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼</button>
                <button class="error-btn error-btn-primary" onclick="closeError()">é–‰ã˜ã‚‹</button>
            </div>
        </div>
    </div>
    
    <!-- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æƒ…å ±ãƒ‘ãƒãƒ« -->
    <div class="compiler-info" id="compiler-info">
        AssemblyScript: <span id="compiler-version">-</span> <span id="version-source" class="version-source">-</span><br>
        CDN Provider: <span id="cdn-provider" class="cdn-status">-</span><br>
        Load Time: <span id="load-time">-</span>ms<br>
        Attempts: <span id="load-attempts">-</span>
    </div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆv1.3.1 å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œç‰ˆï¼‰ -->
    <script type="module">
        // ============================================
        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆv1.3.1æ–°è¦ï¼‰
        // ============================================
        const VersionManager = {
            cache: {
                get() {
                    try {
                        const cached = sessionStorage.getItem('asc_version_cache');
                        if (cached) {
                            const data = JSON.parse(cached);
                            if (Date.now() - data.timestamp < 3600000) {
                                return data.version;
                            }
                        }
                    } catch (e) {}
                    return null;
                },
                set(version) {
                    try {
                        sessionStorage.setItem('asc_version_cache', JSON.stringify({
                            version,
                            timestamp: Date.now()
                        }));
                    } catch (e) {}
                }
            },
            
            async getLatestVersion() {
                const cached = this.cache.get();
                if (cached) {
                    console.log(`[Version] Using cached: ${cached}`);
                    return cached;
                }
                
                const strategies = [
                    { name: 'jsDelivr API', fn: () => this.fetchFromJsDelivr() },
                    { name: 'jsDelivr Package', fn: () => this.fetchJsDelivrPackageJson() },
                    { name: 'Unpkg', fn: () => this.fetchFromUnpkg() }
                ];
                
                for (const strategy of strategies) {
                    try {
                        console.log(`[Version] Trying ${strategy.name}...`);
                        const version = await Promise.race([
                            strategy.fn(),
                            this.timeout(3000)
                        ]);
                        
                        if (version && this.isValidStableVersion(version)) {
                            console.log(`[Version] Success: ${version}`);
                            this.cache.set(version);
                            return version;
                        }
                    } catch (e) {
                        console.warn(`[Version] ${strategy.name} failed`);
                    }
                }
                
                return "0.28.8";
            },
            
            async fetchFromJsDelivr() {
                const response = await fetch('https://data.jsdelivr.com/v1/package/npm/assemblyscript');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                const stable = data.versions.filter(v => this.isValidStableVersion(v));
                if (stable.length === 0) throw new Error('No stable versions found');
                
                return stable[0];
            },
            
            async fetchJsDelivrPackageJson() {
                const response = await fetch('https://cdn.jsdelivr.net/npm/assemblyscript@latest/package.json');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                return data.version;
            },
            
            async fetchFromUnpkg() {
                const response = await fetch('https://unpkg.com/assemblyscript@latest/package.json');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                return data.version;
            },
            
            isValidStableVersion(version) {
                const semverRegex = /^(\d+)\.(\d+)\.(\d+)$/;
                if (!version.match(semverRegex)) return false;
                
                const preRelease = ['alpha', 'beta', 'rc', 'dev', '-'];
                return !preRelease.some(indicator => 
                    version.toLowerCase().includes(indicator)
                );
            },
            
            timeout(ms) {
                return new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('Timeout')), ms)
                );
            }
        };
        
        // ============================================
        // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
        // ============================================
        const COMPILER_METADATA = {
            version: null,
            versionSource: null,
            fetchedFrom: "NPM Registry via CDN",
            generatedAt: new Date().toISOString(),
            cdnProvider: null,
            loadTime: null,
            attempts: 0,
            
            async initialize() {
                const startTime = performance.now();
                try {
                    this.version = await VersionManager.getLatestVersion();
                    this.versionSource = 'Dynamic';
                    console.log(`[Version] Fetched: v${this.version}`);
                } catch (error) {
                    this.version = "0.28.8";
                    this.versionSource = 'Fallback';
                    console.warn('[Version] Using fallback version');
                }
                const fetchTime = Math.round(performance.now() - startTime);
                console.log(`[Version] Time: ${fetchTime}ms`);
            }
        };
        
        // ============================================
        // CDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å®šç¾©ï¼ˆv1.3.1ç°¡ç´ åŒ–ç‰ˆï¼‰
        // ============================================
        const CDN_PROVIDERS = [
            {
                name: 'jsDelivr',
                baseUrl: 'https://cdn.jsdelivr.net/npm',
                timeout: 10000,
                priority: 1
            },
            {
                name: 'UNPKG',
                baseUrl: 'https://unpkg.com',
                timeout: 10000,
                priority: 2
            }
        ];
        
        // ============================================
        // å®‰å…¨ãªåˆæœŸåŒ–
        // ============================================
        let wasmExports = null;
        let isCompiling = false;
        let menuOpen = false;
        let statsVisible = false;
        
        // UIåˆ¶å¾¡é–¢æ•°
        function toggleMenu() {
            menuOpen = !menuOpen;
            const hamburger = document.getElementById('hamburger');
            const sideMenu = document.getElementById('sideMenu');
            const overlay = document.getElementById('overlay');
            const mainContainer = document.getElementById('mainContainer');
            const statusBar = document.getElementById('statusBar');
            
            if (menuOpen) {
                hamburger.classList.add('active');
                sideMenu.classList.add('active');
                overlay.classList.add('active');
                mainContainer.classList.add('menu-open');
                statusBar.classList.add('menu-open');
            } else {
                hamburger.classList.remove('active');
                sideMenu.classList.remove('active');
                overlay.classList.remove('active');
                mainContainer.classList.remove('menu-open');
                statusBar.classList.remove('menu-open');
            }
        }
        
        function closeMenu() {
            if (menuOpen) {
                toggleMenu();
            }
        }
        
        function toggleStats() {
            statsVisible = !statsVisible;
            const statsToggle = document.getElementById('statsToggle');
            const statusBar = document.getElementById('statusBar');
            
            if (statsVisible) {
                statsToggle.classList.add('active');
                statusBar.classList.add('active');
            } else {
                statsToggle.classList.remove('active');
                statusBar.classList.remove('active');
            }
            
            localStorage.setItem('statsVisible', statsVisible);
        }
        
        function switchTab(tabName) {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.tab-button').classList.add('active');
            
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            if (tabName === 'app') {
                document.getElementById('appTab').classList.add('active');
            } else if (tabName === 'wasm') {
                document.getElementById('wasmTab').classList.add('active');
            }
        }
        
        window.toggleMenu = toggleMenu;
        window.closeMenu = closeMenu;
        window.toggleStats = toggleStats;
        window.switchTab = switchTab;
        
        function updateStatus(status, message) {
            const dot = document.getElementById('status-dot');
            const text = document.getElementById('status-text');
            
            if (dot) {
                dot.className = 'status-dot';
                if (status === 'loading') dot.classList.add('loading');
                if (status === 'error') dot.classList.add('error');
            }
            if (text) text.textContent = message;
            
            const progressContainer = document.getElementById('progress-container');
            if (progressContainer) {
                if (status === 'loading') {
                    progressContainer.classList.add('loading');
                } else {
                    progressContainer.classList.remove('loading');
                }
            }
        }
        
        function updateProgress(percent, message, detail = null) {
            const progressBar = document.getElementById('progress-bar');
            const statusText = document.getElementById('status-text');
            
            if (progressBar) progressBar.style.width = `${percent}%`;
            if (statusText) {
                let text = message;
                if (detail) text += ` (${detail})`;
                statusText.textContent = text;
            }
            
            console.log(`[Progress] ${percent}% - ${message}${detail ? ` (${detail})` : ''}`);
        }
        
        // ============================================
        // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ­ãƒ¼ãƒ€ãƒ¼ï¼ˆv1.3.1ç°¡ç´ åŒ–ç‰ˆï¼‰
        // ============================================
        async function loadCompilerWithCDNFallback() {
            const version = COMPILER_METADATA.version;
            console.log(`[Loader] Starting load for AssemblyScript ${version}`);
            
            for (let i = 0; i < CDN_PROVIDERS.length; i++) {
                const cdn = CDN_PROVIDERS[i];
                const startTime = performance.now();
                
                try {
                    updateProgress(30 + (i * 35), 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©èª­ã¿è¾¼ã¿ä¸­', `${cdn.name} (å„ªå…ˆåº¦${cdn.priority})`);
                    
                    const webJsUrl = `${cdn.baseUrl}/assemblyscript@${version}/dist/web.js`;
                    console.log(`[Loader] Attempting ${cdn.name}: ${webJsUrl}`);
                    
                    await loadWebJS(webJsUrl, cdn.timeout);
                    await waitForImportMap();
                    
                    const asc = await import("assemblyscript/asc");
                    const compiler = asc.default || asc;
                    
                    await validateCompiler(compiler);
                    
                    const loadTime = Math.round(performance.now() - startTime);
                    COMPILER_METADATA.cdnProvider = cdn.name;
                    COMPILER_METADATA.loadTime = loadTime;
                    COMPILER_METADATA.attempts = i + 1;
                    
                    console.log(`[Loader] Success with ${cdn.name} in ${loadTime}ms`);
                    updateProgress(100, 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æº–å‚™å®Œäº†');
                    
                    updateCompilerInfo();
                    
                    return compiler;
                    
                } catch (error) {
                    console.error(`[Loader] ${cdn.name} failed:`, error.message);
                    cleanupFailedScripts();
                    
                    delete window.ASSEMBLYSCRIPT_VERSION;
                    delete window.ASSEMBLYSCRIPT_IMPORTMAP;
                }
            }
            
            throw new Error(`Failed to load AssemblyScript ${version} from all CDN providers`);
        }
        
        function loadWebJS(url, timeout) {
            return new Promise((resolve, reject) => {
                if (window.ASSEMBLYSCRIPT_VERSION) {
                    console.log('[Loader] AssemblyScript already loaded');
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = url;
                script.dataset.assemblyScript = 'loading';
                
                const timeoutId = setTimeout(() => {
                    script.remove();
                    reject(new Error(`Timeout loading: ${url}`));
                }, timeout);
                
                script.onload = () => {
                    clearTimeout(timeoutId);
                    script.dataset.assemblyScript = 'loaded';
                    console.log('[Loader] Script loaded successfully');
                    setTimeout(resolve, 300);
                };
                
                script.onerror = () => {
                    clearTimeout(timeoutId);
                    script.remove();
                    reject(new Error(`Failed to load script: ${url}`));
                };
                
                document.head.appendChild(script);
            });
        }
        
        async function waitForImportMap() {
            const maxAttempts = 20;
            const waitTime = 100;
            
            for (let i = 0; i < maxAttempts; i++) {
                if (window.ASSEMBLYSCRIPT_VERSION) {
                    console.log('[Loader] Import map and globals ready');
                    return;
                }
                await new Promise(resolve => setTimeout(resolve, waitTime));
            }
            
            throw new Error('Import map setup timeout');
        }
        
        async function validateCompiler(compiler) {
            if (!compiler || typeof compiler.main !== 'function') {
                throw new Error('Invalid compiler object structure');
            }
            
            const testCode = 'export function test(): i32 { return 42; }';
            const { error } = await compiler.main(['test.ts', '--validate'], {
                readFile: (name) => name === 'test.ts' ? testCode : null,
                writeFile: () => {},
                listFiles: () => ['test.ts']
            });
            
            if (error) {
                throw new Error('Compiler validation failed');
            }
            
            console.log('[Loader] Compiler validated successfully');
        }
        
        function cleanupFailedScripts() {
            const scripts = document.querySelectorAll('script[data-assembly-script]');
            scripts.forEach(script => {
                if (script.dataset.assemblyScript !== 'loaded') {
                    console.log('[Loader] Removing failed script tag');
                    script.remove();
                }
            });
        }
        
        function updateCompilerInfo() {
            document.getElementById('compiler-version').textContent = COMPILER_METADATA.version;
            
            const sourceEl = document.getElementById('version-source');
            sourceEl.textContent = COMPILER_METADATA.versionSource;
            sourceEl.className = COMPILER_METADATA.versionSource === 'Fallback' ? 
                'version-source fallback' : 'version-source';
            
            const cdnEl = document.getElementById('cdn-provider');
            cdnEl.textContent = COMPILER_METADATA.cdnProvider;
            cdnEl.className = `cdn-status ${COMPILER_METADATA.cdnProvider.toLowerCase()}`;
            
            document.getElementById('load-time').textContent = COMPILER_METADATA.loadTime;
            document.getElementById('load-attempts').textContent = COMPILER_METADATA.attempts;
        }
        
        async function safeInit() {
            try {
                console.log('[Init] Starting initialization...');
                
                await COMPILER_METADATA.initialize();
                console.log('[Init] Using AssemblyScript version:', COMPILER_METADATA.version);
                
                const asc = await loadCompilerWithCDNFallback();
                
                if (!asc) {
                    throw new Error('Failed to load compiler');
                }
                
                window.asc = asc;
                
                if (localStorage.getItem('debug') === 'true') {
                    document.getElementById('compiler-info').classList.add('show');
                }
                
                await initializeApp(asc);
                
            } catch (error) {
                console.error('[Init] Failed to initialize:', error);
                showFatalError(`ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆv${COMPILER_METADATA.version}ï¼‰ã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚`);
            }
        }
        
        // ============================================
        // ãƒ—ãƒªã‚»ãƒƒãƒˆå®šç¾©
        // ============================================
        const PRESETS = {
            simple: {
                optimize: false,
                runtime: 'minimal'
            },
            debug: {
                optimize: false,
                optimizeLevel: '0',
                debug: true,
                sourceMap: true,
                measure: true
            },
            release: {
                optimize: true,
                optimizeLevel: '3',
                shrinkLevel: '1',
                noAssert: true
            },
            minimal: {
                optimize: true,
                optimizeLevel: '3',
                shrinkLevel: '2',
                runtime: 'stub',
                noAssert: true
            }
        };
        
        // ============================================
        // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚³ã‚¢
        // ============================================
        const CompilerCore = {
            compiler: null,
            
            init(ascInstance) {
                this.compiler = ascInstance;
                return true;
            },
            
            async compile(sourceCode, options) {
                if (!this.compiler) {
                    throw new Error('Compiler not initialized');
                }
                
                const compileOptions = this.buildOptions(options);
                let wasmBinary = null;
                let compileStats = '';
                
                const { error, stdout, stderr } = await this.compiler.main(compileOptions, {
                    readFile: (filename) => {
                        if (filename === "main.ts") return sourceCode;
                        return null;
                    },
                    writeFile: (filename, contents) => {
                        if (filename === "main.wasm") {
                            wasmBinary = contents;
                        }
                    },
                    listFiles: () => ["main.ts"]
                });
                
                if (error) throw new Error(stderr || error.toString());
                if (!wasmBinary) throw new Error('No WebAssembly binary generated');
                
                if (stdout) compileStats = stdout;
                
                return { wasmBinary, stats: compileStats };
            },
            
            buildOptions(userOptions) {
                const flags = ["main.ts", "-o", "main.wasm"];
                
                Object.entries(userOptions).forEach(([key, value]) => {
                    if (typeof value === 'boolean' && value) {
                        flags.push(`--${key}`);
                    } else if (typeof value !== 'boolean' && value !== '') {
                        flags.push(`--${key}`, value.toString());
                    }
                });
                
                return flags;
            }
        };
        
        // ============================================
        // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†
        // ============================================
        const OptionsManager = {
            current: {},
            
            init() {
                this.current = { runtime: 'minimal' };
                this.loadFromStorage();
                this.updateUI();
            },
            
            apply(preset) {
                if (PRESETS[preset]) {
                    this.current = { ...PRESETS[preset] };
                    this.updateUI();
                    this.saveToStorage();
                }
            },
            
            collectFromUI() {
                const options = {};
                
                ['optimize', 'exportRuntime', 'noAssert', 'debug', 'sourceMap',
                 'measure', 'validate', 'importMemory', 'sharedMemory',
                 'exportTable', 'explicitStart', 'lowMemoryLimit'].forEach(opt => {
                    const el = document.getElementById(`opt-${opt}`);
                    if (el && el.checked) options[opt] = true;
                });
                
                ['optimizeLevel', 'shrinkLevel', 'runtime'].forEach(opt => {
                    const el = document.getElementById(`opt-${opt}`);
                    if (el && el.value) options[opt] = el.value;
                });
                
                this.current = options;
                this.saveToStorage();
                return options;
            },
            
            updateUI() {
                Object.keys(this.current).forEach(key => {
                    const el = document.getElementById(`opt-${key}`);
                    if (el) {
                        if (el.type === 'checkbox') {
                            el.checked = this.current[key] === true;
                        } else {
                            el.value = this.current[key] || '';
                        }
                    }
                });
            },
            
            saveToStorage() {
                try {
                    localStorage.setItem('asmOptions', JSON.stringify(this.current));
                } catch(e) {}
            },
            
            loadFromStorage() {
                try {
                    const saved = localStorage.getItem('asmOptions');
                    if (saved) this.current = JSON.parse(saved);
                } catch(e) {}
            }
        };
        
        // ============================================
        // WebAssemblyå®Ÿè¡Œç®¡ç†
        // ============================================
        const WasmRunner = {
            instance: null,
            
            async instantiate(wasmBinary, imports = {}) {
                const defaultImports = {
                    env: {
                        abort: (msg, file, line, column) => {
                            console.error(`Abort: ${msg} at ${file}:${line}:${column}`);
                        },
                        trace: (msg, n, ...args) => {
                            console.log(`Trace: ${msg}`, ...args);
                        },
                        seed: () => Date.now(),
                        memory: new WebAssembly.Memory({ initial: 1 })
                    },
                    Math: Math,
                    Date: Date
                };
                
                const mergedImports = this.mergeImports(defaultImports, imports);
                
                let buffer;
                if (wasmBinary instanceof ArrayBuffer) {
                    buffer = wasmBinary;
                } else if (wasmBinary instanceof Uint8Array) {
                    buffer = wasmBinary.buffer.slice(wasmBinary.byteOffset, 
                                                     wasmBinary.byteOffset + wasmBinary.byteLength);
                } else {
                    throw new Error('Unexpected binary format');
                }
                
                const wasmModule = await WebAssembly.compile(buffer);
                this.instance = await WebAssembly.instantiate(wasmModule, mergedImports);
                
                return this.instance.exports;
            },
            
            mergeImports(defaults, custom) {
                const merged = { ...defaults };
                Object.keys(custom).forEach(key => {
                    if (typeof custom[key] === 'object' && !Array.isArray(custom[key])) {
                        merged[key] = { ...defaults[key], ...custom[key] };
                    } else {
                        merged[key] = custom[key];
                    }
                });
                return merged;
            }
        };
        
        // ============================================
        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
        // ============================================
        const AppModule = {
            name: "DefaultDemo",
            description: "ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
            
            sourceCode: `
// Simple counter example
let counter: i32 = 0;

export function increment(): i32 {
    counter++;
    return counter;
}

export function decrement(): i32 {
    counter--;
    return counter;
}

export function getValue(): i32 {
    return counter;
}

export function reset(): void {
    counter = 0;
}
            `.trim(),
            
            defaultOptions: {
                optimize: false,
                runtime: 'minimal'
            },
            
            getImports() {
                return {};
            },
            
            async init(wasmExports) {
                if (wasmExports.reset) {
                    wasmExports.reset();
                }
            },
            
            execute(wasmExports) {
                const value = wasmExports.getValue ? wasmExports.getValue() : 0;
                this.render({ counter: value });
            },
            
            render(data) {
                const viewport = document.getElementById('app-viewport');
                viewport.innerHTML = `
                    <div style="text-align: center;">
                        <div style="font-size: 96px; font-weight: 200; color: #667eea; line-height: 1; margin-bottom: 32px;">
                            ${data.counter}
                        </div>
                        <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="appIncrement()">+1</button>
                            <button class="btn btn-primary" onclick="appDecrement()">-1</button>
                            <button class="btn btn-primary" style="background: white; color: #667eea; border: 2px solid #667eea;" onclick="appReset()">Reset</button>
                        </div>
                    </div>
                `;
            }
        };
        
        // ============================================
        // çµ±è¨ˆæƒ…å ±æ›´æ–°
        // ============================================
        function updateStats(compileTime, wasmSize) {
            document.getElementById('stat-compile-time').textContent = 
                compileTime ? `${compileTime}ms` : '-';
            document.getElementById('stat-wasm-size').textContent = 
                wasmSize ? `${(wasmSize / 1024).toFixed(1)}KB` : '-';
            
            const optLevel = document.getElementById('opt-optimize').checked ? 
                (document.getElementById('opt-optimizeLevel').value || 'default') : 'OFF';
            document.getElementById('stat-opt-level').textContent = optLevel;
            
            if (wasmExports && wasmExports.memory) {
                const pages = wasmExports.memory.buffer.byteLength / (64 * 1024);
                document.getElementById('stat-memory').textContent = `${pages} page${pages !== 1 ? 's' : ''}`;
            }
        }
        
        // ============================================
        // ã‚¨ãƒ©ãƒ¼å‡¦ç†
        // ============================================
        function showError(error) {
            console.error(error);
            document.getElementById('error-content').textContent = 
                error.stack || error.message || String(error);
            document.getElementById('error-overlay').style.display = 'flex';
            updateStatus('error', 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
        }
        
        window.closeError = function() {
            document.getElementById('error-overlay').style.display = 'none';
        };
        
        window.copyError = async function() {
            const content = document.getElementById('error-content').textContent;
            try {
                await navigator.clipboard.writeText(content);
                alert('ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
            } catch(e) {
                console.error('Copy failed:', e);
            }
        };
        
        window.applyPreset = function(preset) {
            OptionsManager.apply(preset);
            recompile();
        };
        
        // ============================================
        // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å‡¦ç†
        // ============================================
        async function compile() {
            if (isCompiling) return;
            isCompiling = true;
            
            const startTime = performance.now();
            
            try {
                updateStatus('loading', 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ä¸­...');
                
                const options = OptionsManager.collectFromUI();
                const { wasmBinary, stats } = await CompilerCore.compile(
                    AppModule.sourceCode, 
                    options
                );
                
                const imports = AppModule.getImports();
                wasmExports = await WasmRunner.instantiate(wasmBinary, imports);
                
                const compileTime = Math.round(performance.now() - startTime);
                const wasmSize = wasmBinary.byteLength || wasmBinary.length;
                
                updateStats(compileTime, wasmSize);
                
                if (AppModule.init) {
                    await AppModule.init(wasmExports);
                }
                
                updateStatus('ready', 'å®Ÿè¡Œä¸­');
                
                if (AppModule.execute) {
                    AppModule.execute(wasmExports);
                }
                
                return true;
            } catch (error) {
                showError(error);
                return false;
            } finally {
                isCompiling = false;
            }
        }
        
        async function recompile() {
            const btn = document.getElementById('recompileBtn');
            const originalText = btn.textContent;
            btn.textContent = 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ä¸­...';
            btn.disabled = true;
            
            await compile();
            
            btn.textContent = originalText;
            btn.disabled = false;
            
            closeMenu();
        }
        
        window.recompile = recompile;
        
        // ============================================
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ï¼ˆAppModuleã‹ã‚‰å‘¼ã³å‡ºã—å¯èƒ½ï¼‰
        // ============================================
        window.appIncrement = function() {
            if (wasmExports && wasmExports.increment) {
                wasmExports.increment();
                AppModule.execute(wasmExports);
            }
        };
        
        window.appDecrement = function() {
            if (wasmExports && wasmExports.decrement) {
                wasmExports.decrement();
                AppModule.execute(wasmExports);
            }
        };
        
        window.appReset = function() {
            if (wasmExports && wasmExports.reset) {
                wasmExports.reset();
                AppModule.execute(wasmExports);
            }
        };
        
        // ============================================
        // Fatal errorè¡¨ç¤º
        // ============================================
        function showFatalError(message) {
            document.getElementById('status-text').textContent = message;
            document.getElementById('status-dot').className = 'status-dot error';
            document.getElementById('app-viewport').innerHTML = `
                <div style="text-align: center; color: #dc3545;">
                    <div style="font-size: 48px; margin-bottom: 16px;">âš ï¸</div>
                    <div style="font-size: 18px; font-weight: bold;">åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼</div>
                    <div style="margin-top: 12px; color: #6c757d;">${message}</div>
                    <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿
                    </button>
                </div>
            `;
        }
        
        // ============================================
        // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
        // ============================================
        async function initializeApp(asc) {
            console.log('[Init] Starting application initialization...');
            console.log('[Init] Version:', COMPILER_METADATA.version, `(${COMPILER_METADATA.versionSource})`);
            console.log('[Init] Compiler loaded via:', COMPILER_METADATA.cdnProvider);
            console.log('[Init] Load time:', COMPILER_METADATA.loadTime + 'ms');
            console.log('[Init] Attempts:', COMPILER_METADATA.attempts);
            
            document.getElementById('app-title').textContent = `ğŸš€ ${AppModule.name}`;
            document.getElementById('app-description').textContent = AppModule.description;
            
            document.getElementById('source-code').textContent = AppModule.sourceCode;
            
            const showCodeCheckbox = document.getElementById('showCode');
            const sourceContent = document.getElementById('sourceContent');
            
            if (showCodeCheckbox && sourceContent) {
                showCodeCheckbox.addEventListener('change', () => {
                    sourceContent.style.display = showCodeCheckbox.checked ? 'block' : 'none';
                });
            }
            
            const savedStatsVisible = localStorage.getItem('statsVisible');
            if (savedStatsVisible === 'true') {
                statsVisible = true;
                document.getElementById('statsToggle').classList.add('active');
                document.getElementById('statusBar').classList.add('active');
            }
            
            CompilerCore.init(asc);
            OptionsManager.init();
            
            if (AppModule.defaultOptions) {
                OptionsManager.current = { ...AppModule.defaultOptions };
                OptionsManager.updateUI();
            }
            
            updateStatus('loading', 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æº–å‚™ä¸­...');
            
            await compile();
            
            console.log('[Init] Application initialized successfully');
        }
        
        // ============================================
        // ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
        // ============================================
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('[Init] DOM ready, preparing initialization...');
            document.getElementById('status-text').textContent = 'ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’èª­ã¿è¾¼ã¿ä¸­...';
        });
        
        setTimeout(() => {
            safeInit().catch(error => {
                console.error('[Init] Initialization failed:', error);
                showFatalError('åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            });
        }, 100);
    </script>
</body>
</html>
```

---

## **ğŸ¤– æ±ç”¨AIå®Ÿè£…ã‚¬ã‚¤ãƒ‰**

### **ã‚¹ãƒ†ãƒƒãƒ—0å®Ÿè¡Œã®é‡è¦æ€§**

ç”ŸæˆAIãŒHTMLã‚’ç”Ÿæˆã™ã‚‹éš›ã€**å¿…ãšæœ€åˆã«ã‚¹ãƒ†ãƒƒãƒ—0ã‚’å®Ÿè¡Œ**ã—ã¦ãã ã•ã„ï¼š

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ã®æ˜ç¢ºæ€§ã‚’ç¢ºèª**
2. **ä¸æ˜ç¢ºãªå ´åˆã¯ä½œæ¥­ã‚’ä¸­æ–­ã—ã¦å•ã„åˆã‚ã›**
3. **æ˜ç¢ºãªå›ç­”ã‚’å¾—ã¦ã‹ã‚‰å®Ÿè£…ã‚’é–‹å§‹**
4. **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ãƒ—ãƒªã®è‡ªå‹•ç”Ÿæˆã¯å³ç¦**

### **å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—ã®å®Ÿè£…**

ç”ŸæˆAIãŒHTMLã‚’ç”Ÿæˆã™ã‚‹éš›ã€ä»¥ä¸‹ã®æ‰‹é †ã§æœ€æ–°ç‰ˆã‚’å–å¾—ã—ã¦ãã ã•ã„ï¼š

1. **VersionManagerã‚’çµ„ã¿è¾¼ã‚€**
2. **jsDelivr APIå„ªå…ˆã§è©¦è¡Œ**
3. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦0.28.8ã‚’ä½¿ç”¨**
4. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ã‚’æ´»ç”¨**

### **å…¬å¼æ¨å¥¨æ–¹å¼äº’æ›ã®éµå®ˆ**

ç”ŸæˆAIãŒHTMLã‚’ç”Ÿæˆã™ã‚‹éš›ã€ä»¥ä¸‹ã®å®Ÿè£…æ–¹é‡ã‚’å³å®ˆã—ã¦ãã ã•ã„ï¼š

1. **ç›´æ¥importã¯çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„**
2. **å¿…ãšweb.jsçµŒç”±ã§ãƒ­ãƒ¼ãƒ‰**
3. **CDNã¯jsDelivrã¨UNPKGã®2ã¤ã®ã¿**
4. **import mapã®è¨­å®šã‚’å¾…æ©Ÿ**

### **å®Ÿè£…ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ**

```
0. ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ã‚’å—ä¿¡
   â†“
1. è¦æ±‚ã®æ˜ç¢ºæ€§ã‚’ç¢ºèªï¼ˆã‚¹ãƒ†ãƒƒãƒ—0ï¼‰
   â”œâ”€ ä¸æ˜ç¢º â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å•ã„åˆã‚ã› â†’ å›ç­”å¾…ã¡
   â””â”€ æ˜ç¢º â†’ æ¬¡ã¸é€²è¡Œ
   â†“
2. å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—
   â†“
3. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹åˆ¤å®š
   â†“
4. AssemblyScriptã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
   â†“
5. AppModuleç”Ÿæˆ
   â†“
6. HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆv1.3.1ã‚’ä½¿ç”¨
   â†“
7. å˜ä¸€HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›
```

### **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹åˆ¥å®Ÿè£…ä¾‹**

#### **1. ç‰©ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒœãƒ¼ãƒ«ï¼‰**

```javascript
const AppModule = {
    name: "Ball Physics Demo",
    description: "ç‰©ç†æ¼”ç®—ã«ã‚ˆã‚‹ãƒœãƒ¼ãƒ«ã®å‹•ãã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³",
    
    sourceCode: `
export class Ball {
    x: f32 = 300.0;
    y: f32 = 200.0;
    vx: f32 = 3.0;
    vy: f32 = 2.0;
    radius: f32 = 15.0;
}

let ball = new Ball();

export function update(): void {
    ball.x += ball.vx;
    ball.y += ball.vy;
    
    if (ball.x - ball.radius <= 0 || ball.x + ball.radius >= 600) {
        ball.vx = -ball.vx;
    }
    if (ball.y - ball.radius <= 0 || ball.y + ball.radius >= 400) {
        ball.vy = -ball.vy;
    }
}

export function getX(): f32 { return ball.x; }
export function getY(): f32 { return ball.y; }
export function getRadius(): f32 { return ball.radius; }
    `.trim(),
    
    async init(wasmExports) {
        const viewport = document.getElementById('app-viewport');
        viewport.innerHTML = '<canvas id="canvas" width="600" height="400" style="border: 1px solid #e5e7eb; border-radius: 8px;"></canvas>';
    },
    
    execute(wasmExports) {
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        function animate() {
            wasmExports.update();
            
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, 600, 400);
            
            const x = wasmExports.getX();
            const y = wasmExports.getY();
            const r = wasmExports.getRadius();
            
            ctx.fillStyle = '#667eea';
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fill();
            
            requestAnimationFrame(animate);
        }
        animate();
    }
};
```

#### **2. ç”»åƒãƒ•ã‚£ãƒ«ã‚¿å‡¦ç†**

```javascript
const AppModule = {
    name: "Image Filter Processor",
    description: "é«˜é€Ÿç”»åƒãƒ•ã‚£ãƒ«ã‚¿å‡¦ç†",
    
    sourceCode: `
// Grayscale filter
export function applyGrayscale(pixels: Uint8ClampedArray): void {
    for (let i = 0; i < pixels.length; i += 4) {
        const gray = <u8>(pixels[i] * 0.299 + pixels[i+1] * 0.587 + pixels[i+2] * 0.114);
        pixels[i] = gray;
        pixels[i+1] = gray;
        pixels[i+2] = gray;
    }
}
    `.trim(),
    
    defaultOptions: {
        optimize: true,
        optimizeLevel: '3'
    },
    
    // ... ç”»åƒå‡¦ç†ç”¨ã®UIå®Ÿè£…
};
```

---

## **ğŸ“š ä»˜éŒ²**

### **AssemblyScriptå‹å¯¾å¿œè¡¨**

| AssemblyScript | JavaScript | ç”¨é€” |
|---------------|------------|------|
| i32 | number | æ•´æ•°æ¼”ç®— |
| f32 | number | å˜ç²¾åº¦æµ®å‹•å°æ•°ç‚¹ |
| f64 | number | å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹ |
| i64 | BigInt | å¤§ããªæ•´æ•° |
| bool | boolean | çœŸå½å€¤ |

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™**

- åˆå›ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«: < 5ç§’
- å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«: < 3ç§’
- WASMã‚µã‚¤ã‚º: 1KBï½50KBï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ä¾å­˜ï¼‰
- å®Ÿè¡Œé€Ÿåº¦: JavaScriptã®2ï½10å€ï¼ˆå‡¦ç†å†…å®¹ä¾å­˜ï¼‰

### **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**

| å•é¡Œ | åŸå›  | è§£æ±ºç­– |
|------|------|---------|
| "import map not found" | web.jsèª­ã¿è¾¼ã¿å¤±æ•— | CDNãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒè‡ªå‹•å¯¾å¿œ |
| ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©èª­ã¿è¾¼ã¿å¤±æ•— | CDNéšœå®³/ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ | 2ã¤ã®CDNã§è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤ |
| ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ | é…ã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ | æ¬¡ã®CDNã«è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸ä¸€è‡´ | ç ´å£Šçš„å¤‰æ›´ | å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—ãŒå¯¾å¿œ |
| ä½ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | æœ€é©åŒ–ãªã— | --optimizeã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ– |
| å¤§ããªWASMã‚µã‚¤ã‚º | ãƒ‡ãƒãƒƒã‚°æƒ…å ± | --debugã‚’ç„¡åŠ¹åŒ–ã€--shrinkLevelã‚’ä¸Šã’ã‚‹ |

### **ãƒ‡ãƒãƒƒã‚°ã®ãƒ’ãƒ³ãƒˆ**

```javascript
// ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã§ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹åŒ–
localStorage.setItem('debug', 'true');

// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æƒ…å ±ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆv1.3.1å¼·åŒ–ï¼‰
// - AssemblyScriptãƒãƒ¼ã‚¸ãƒ§ãƒ³
// - ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—å…ƒï¼ˆDynamic/Fallbackï¼‰
// - ä½¿ç”¨ã—ãŸCDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆè‰²åˆ†ã‘è¡¨ç¤ºï¼‰
// - èª­ã¿è¾¼ã¿æ™‚é–“
// - è©¦è¡Œå›æ•°

// ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è©³ç´°ãƒ­ã‚°ç¢ºèª
// [Version] ã‚¿ã‚°ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—çŠ¶æ³
// [Loader] ã‚¿ã‚°ã§èª­ã¿è¾¼ã¿é€²è¡ŒçŠ¶æ³
// [Init] ã‚¿ã‚°ã§åˆæœŸåŒ–çŠ¶æ³
// [Progress] ã‚¿ã‚°ã§é€²æ—çŠ¶æ³
```

### **CDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è©³ç´°**

| CDN | URL | ç‰¹å¾´ | æ¨å¥¨ç”¨é€” |
|-----|-----|------|----------|
| **jsDelivr** | cdn.jsdelivr.net | æœ€é€Ÿãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«CDNãƒ»å…¬å¼æ¨å¥¨ | ç¬¬1é¸æŠ |
| **UNPKG** | unpkg.com | npmå…¬å¼ãƒŸãƒ©ãƒ¼ãƒ»å®Œå…¨æ€§ä¿è¨¼ | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ |

---

## **ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**

MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ - è‡ªç”±ã«ä½¿ç”¨ãƒ»æ”¹å¤‰ãƒ»å†é…å¸ƒãƒ»å•†ç”¨åˆ©ç”¨å¯èƒ½

---

## **ğŸ“„ æ›´æ–°å±¥æ­´**

### **v1.3.1** (2025-01) - å®‰å®šæ€§ã¨ã‚·ãƒ³ãƒ—ãƒ«åŒ–ã®å‘ä¸Š
**ä¸»ãªå¤‰æ›´å†…å®¹ï¼š**
- âœ… **å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—æ©Ÿèƒ½è¿½åŠ **: jsDelivr APIå„ªå…ˆã§ã®æœ€æ–°ç‰ˆå–å¾—
- âœ… **CDNæœ€é©åŒ–**: esm.shã‚’é™¤å¤–ã—2ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ä½“åˆ¶ã¸
- âœ… **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
- âœ… **åˆæœŸåŒ–æ™‚é–“çŸ­ç¸®**: æœ€æ‚ªã‚±ãƒ¼ã‚¹30ç§’â†’20ç§’
- âœ… **ãƒ‡ãƒãƒƒã‚°æƒ…å ±å¼·åŒ–**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—å…ƒã®å¯è¦–åŒ–

**æŠ€è¡“çš„æ”¹å–„ï¼š**
- jsDelivrå…¬å¼æ¨å¥¨ã¸ã®å®Œå…¨æº–æ‹ 
- ã‚³ãƒ¼ãƒ‰ã®ã‚·ãƒ³ãƒ—ãƒ«åŒ–ã«ã‚ˆã‚‹ä¿å®ˆæ€§å‘ä¸Š
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„
- UIãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®è©³ç´°åŒ–

### **v1.3.0** (2025-09) - å…¬å¼æ¨å¥¨æ–¹å¼äº’æ›ã¸ã®å®Œå…¨ç§»è¡Œ
**ä¸»ãªå¤‰æ›´å†…å®¹ï¼š**
- âœ… **èª­ã¿è¾¼ã¿æ–¹å¼ã®çµ±ä¸€**: å…¬å¼äº’æ›ã®web.jsæ–¹å¼ã®ã¿ã‚’ä½¿ç”¨
- âœ… **ç›´æ¥importã®å‰Šé™¤**: å•é¡Œã®å¤šã„ç›´æ¥importæ–¹å¼ã‚’å®Œå…¨å‰Šé™¤
- âœ… **3ã¤ã®CDNãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**: jsDelivr â†’ UNPKG â†’ esm.sh
- âœ… **å®Ÿè£…ã®ç°¡ç´ åŒ–**: å˜ä¸€ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä¿å®ˆæ€§å¤§å¹…å‘ä¸Š

### **v1.2.2** (2025-09) - å…¬å¼äº’æ›å®Ÿè£…ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã®è¿½åŠ 
**ä¸»ãªå¤‰æ›´å†…å®¹ï¼š**
- âœ… **3æ®µéšãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿæ§‹**: ç›´æ¥import â†’ ä»£æ›¿CDN â†’ å…¬å¼web.js
- âœ… **å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: GitHubã‚¿ã‚°ã‹ã‚‰æœ€æ–°å®‰å®šç‰ˆã‚’å–å¾—
- âœ… **@latestç¦æ­¢ãƒ«ãƒ¼ãƒ«**: å…·ä½“çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šã‚’å¿…é ˆåŒ–
- âœ… **è¨ºæ–­æ©Ÿèƒ½å¼·åŒ–**: èª­ã¿è¾¼ã¿æ–¹æ³•ã®ãƒ­ã‚®ãƒ³ã‚°ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²

### **v1.2.1** (2025-09) - ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ç¢ºèªãƒ—ãƒ­ã‚»ã‚¹ã®è¿½åŠ 
**ä¸»ãªå¤‰æ›´å†…å®¹ï¼š**
- âœ… **ã‚¹ãƒ†ãƒƒãƒ—0è¿½åŠ **: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ãŒä¸æ˜ç¢ºãªå ´åˆã®ç¢ºèªãƒ—ãƒ­ã‚»ã‚¹ã‚’å¿…é ˆåŒ–
- âœ… **ä½œæ¥­ä¸­æ–­ãƒ«ãƒ¼ãƒ«**: æ›–æ˜§ãªæŒ‡ç¤ºã§ã®è‡ªå‹•åˆ¤æ–­ã‚’ç¦æ­¢
- âœ… **å•ã„åˆã‚ã›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**: æ§‹é€ åŒ–ã•ã‚ŒãŸè³ªå•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æä¾›

### **v1.2** (2025-09) - UI/UXå…¨é¢æ”¹è‰¯
**ä¸»ãªå¤‰æ›´å†…å®¹ï¼š**
- âœ… **ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ¡ç”¨**: ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªç”»é¢åˆ©ç”¨
- âœ… **ã‚¿ãƒ–å‹è¨­å®šç®¡ç†**: ã‚¢ãƒ—ãƒªè¨­å®šã¨WebAssemblyè¨­å®šã‚’è«–ç†çš„ã«åˆ†é›¢
- âœ… **WASMçµ±è¨ˆæƒ…å ±ãƒˆã‚°ãƒ«**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆOFFã§å¿…è¦æ™‚ã®ã¿è¡¨ç¤º
- âœ… **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ**: ãƒ¢ãƒã‚¤ãƒ«ã‹ã‚‰ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã¾ã§

### **v1.1** (2025-09) - ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³å•é¡Œã®å®Œå…¨è§£æ±º
**ä¸»ãªå¤‰æ›´å†…å®¹ï¼š**
- âœ… **Dynamic Importæ¡ç”¨**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã«ã‚ˆã‚‹ç›´æ¥èª­ã¿è¾¼ã¿ã‚’å‰Šé™¤
- âœ… **ãƒªãƒˆãƒ©ã‚¤ãƒ¡ã‚«ãƒ‹ã‚ºãƒ è¿½åŠ **: è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤ã¨Exponential Backoff
- âœ… **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä¿è­·**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©èª­ã¿è¾¼ã¿ã«ä¸Šé™è¨­å®š

### **v1.0** (2025-09) - åˆç‰ˆãƒªãƒªãƒ¼ã‚¹
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¡ç”¨
- è‡ªå‹•åˆæœŸåŒ–æ©Ÿèƒ½
- 15ç¨®é¡ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- ã‚¨ãƒ©ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤æ©Ÿèƒ½

---

## **ğŸ“Š ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ¥æ©Ÿèƒ½æ¯”è¼ƒ**

| æ©Ÿèƒ½ | v1.0 | v1.1 | v1.2 | v1.2.1 | v1.2.2 | v1.3.0 | v1.3.1 |
|------|------|------|------|--------|--------|--------|--------|
| åŸºæœ¬ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³å¯¾ç­– | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| ãƒ¢ãƒ€ãƒ³UI | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚ç¢ºèª | âŒ | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… |
| å…¬å¼äº’æ›ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | âŒ | âŒ | âŒ | âŒ | âœ… | âŒ | âŒ |
| å‹•çš„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† | âŒ | âŒ | âŒ | âŒ | âœ… | âœ… | âœ… |
| å…¬å¼æ–¹å¼äº’æ› | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… | âœ… |
| jsDelivrå„ªå…ˆ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… |
| 2CDNä½“åˆ¶ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… |

---

**ç”Ÿæˆæ—¥**: 2025å¹´9æœˆ  
**ãƒ¬ã‚·ãƒ”ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.3.1  
**AssemblyScriptå¯¾å¿œãƒãƒ¼ã‚¸ãƒ§ãƒ³**: å‹•çš„å–å¾—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: 0.28.8ï¼‰
